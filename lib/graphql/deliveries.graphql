fragment BasicDeliveryFragment on Delivery {
    id
    status
    deliveryDate
    order {
        id
        total
        status
        customer {
            id
            email
        }
    }
    driver {
        id
        email
    }
}

fragment DriverDeliveryFragment on Delivery {
    id
    status
    deliveryDate
    restaurant {
        id
        name
    }
    order {
        id
        total
        status
        customer {
            id
            email
        }
        deliveryFirstName
        deliveryLastName
        deliveryPhoneNumber
        deliveryStreet
        deliveryApartment
        deliveryCity
        deliveryZipCode
        orderItems {
            edges {
                node {
                    id
                    quantity
                    mealPlan {
                        id
                        name
                    }
                }
            }
        }
    }
}

query GetDeliveries($first: Int, $after: String, $search: String) {
    deliveries(first: $first, after: $after, search: $search) {
        edges {
            node {
                ...BasicDeliveryFragment
            }
        }
        pageInfo {
            hasNextPage
            endCursor
        }
    }
}

# For drivers - includes their deliveries
query GetUserDeliveries($id: ID!, $first: Int, $after: String, $status: [String], $search: String, $order: [DeliveryFilter_order]) {
    user(id: $id) {
        id
        deliveries(first: $first, after: $after, status_list: $status, search: $search, order: $order) {
            edges {
                node {
                    ...DriverDeliveryFragment
                }
            }
            pageInfo {
                hasNextPage
                endCursor
            }
        }
    }
}

query GetDelivery($id: ID!) {
    delivery(id: $id) {
        ...BasicDeliveryFragment
    }
}

query GetDeliveriesByRestaurant($restaurantId: ID!, $first: Int, $after: String, $status: String, $order: [DeliveryFilter_order], $search: String) {
    restaurant(id: $restaurantId) {
        id
        deliveries(first: $first, after: $after, status: $status, search: $search, order: $order) {
            edges {
                node {
                    ...BasicDeliveryFragment
                }
            }
            pageInfo {
                hasNextPage
                endCursor
            }
        }
    }
}

mutation UpdateDelivery($input: updateDeliveryInput!) {
    updateDelivery(input: $input) {
        delivery {
            id
            status
        }
    }
}

mutation DeleteDelivery($input: deleteDeliveryInput!) {
    deleteDelivery(input: $input) {
        delivery {
            id
        }
    }
}
